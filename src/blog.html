<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Blog — ZapCorp</title>
  <meta name="description" content="Read the latest insights, tech updates, and articles from ZapCorp." />
  <link rel="stylesheet" href="/src/assets/css/styles.css" />
  <link rel="icon" href="/public/favicon.ico" />
</head>

<body>

  <!-- HEADER -->
  <header class="topbar glass">
    <div class="container topbar-inner">
      <a href="/" class="brand">
        <img src="/public/images/logo.png" alt="ZapCorp" class="logo" />
        <span>ZapCorp</span>
      </a>

      <nav class="nav">
        <a href="/src/about.html">About</a>
        <a href="/src/services.html">Services</a>
        <a href="/src/blog.html" class="active">Blog</a>
        <a href="/src/contact.html" class="cta">Contact</a>
      </nav>
    </div>
  </header>

  <main>

    <!-- HERO -->
    <section class="hero glass" style="padding:50px 20px;text-align:center;">
      <h1>ZapCorp Blog</h1>
      <p class="lead">Insights, tutorials, tech strategies & industry news.</p>
    </section>

    <!-- SEARCH BAR -->
    <section class="container" style="margin-top:40px;text-align:center;">
      <input
        id="blogSearch"
        type="text"
        placeholder="Search articles..."
        class="glass"
        style="padding:12px 18px;width:100%;max-width:420px;border-radius:14px;border:1px solid rgba(255,255,255,0.3);outline:none;"
        oninput="filterBlogs()"
      />
    </section>

    <!-- BLOG GRID -->
    <section class="container" style="margin-top:40px;">
      <div id="blogContainer" 
           class="cards" 
           style="grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:24px;">
      
        <!-- BLOG CARDS WILL LOAD HERE VIA JS -->
      
      </div>
    </section>

    <!-- LOADING SPINNER -->
    <div id="loadingSpinner" style="text-align:center;margin-top:40px;display:none;">
      <p class="muted">Loading blogs...</p>
    </div>

  </main>

  <!-- FOOTER -->
  <footer class="footer glass" style="margin-top:40px;padding:20px;">
    <div class="container" style="text-align:center;">
      <p class="muted">© ZapCorp — Intelligent IT Solutions</p>
    </div>
  </footer>

  <script src="/src/assets/js/main.js" defer></script>

  <script>
    // ---- Fetch Blogs from Serverless API ----
    async function loadBlogs() {
      document.getElementById('loadingSpinner').style.display = 'block';

      try {
        const res = await fetch('/api/blogs');
        const blogs = await res.json();

        const container = document.getElementById('blogContainer');
        container.innerHTML = '';

        blogs.forEach(blog => {
          const card = document.createElement('article');
          card.className = 'card glass';
          card.style.cursor = 'pointer';
          card.onclick = () => window.location.href = `/src/blog/${blog.slug}.html`;

          card.innerHTML = `
            <img src="/public/images/blog/${blog.image || 'default.jpg'}" 
                 alt="${blog.title}" 
                 style="width:100%;border-radius:14px;">

            <h3 style="margin-top:12px;">${blog.title}</h3>
            <p class="muted" style="margin-top:4px;">${blog.category}</p>

            <p style="margin-top:10px;">${blog.excerpt || blog.content.substring(0,100)}...</p>

            <a class="btn secondary" style="margin-top:12px;display:inline-block;">
              Read More →
            </a>
          `;
          container.appendChild(card);
        });

        document.getElementById('loadingSpinner').style.display = 'none';

      } catch (error) {
        document.getElementById('loadingSpinner').innerHTML = 
          "<p class='muted'>Failed to load blog posts.</p>";
      }
    }

    loadBlogs();

    // ---- SEARCH FUNCTION ----
    function filterBlogs() {
      const term = document.getElementById('blogSearch').value.toLowerCase();
      const cards = document.querySelectorAll('#blogContainer article');

      cards.forEach(card => {
        const text = card.innerText.toLowerCase();
        card.style.display = text.includes(term) ? '' : 'none';
      });
    }
  </script>

</body>
</html>
